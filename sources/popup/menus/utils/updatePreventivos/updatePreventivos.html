<form id="updatePreventivos" class="sheet-view-container" autocomplete="off">


    <div class="sheet-card mb-1">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <div>
                <div class="fw-semibold text-dark">
                    <i class="fas fa-info-circle me-1"></i> Consultar Mantenimientos Preventivos
                </div>
                <small class="text-muted">
                    Visualice y filtre los mantenimientos preventivos por tipo de equipo.
                </small>
            </div>
            <button type="button" class="btn btn-novedad" id="btnOpenReport">
                <i class="fas fa-envelope"></i> Reportar Novedad
            </button>
        </div>

        <!-- Controles de filtrado -->
        <div class="sheet-toolbar row g-2">
            <div class="col-sm-4 col-12">
                <label for="equipoSelect" class="form-label">
                    <i class="fas fa-filter me-1"></i> Tipo de Equipo
                </label>
                <select class="form-select form-select-sm" id="equipoSelect">
                    <option value="">Seleccione un equipo...</option>
                    <option value="cctv">1. CCTV</option>
                    <option value="ups">2. UPS EST-1</option>
                    <option value="bca">3. BCA</option>
                    <option value="tca">4. TCA</option>
                    <option value="tcs">5. TCS</option>
                    <option value="eqMoviles">6. EQ MOV</option>
                    <option value="pip">7. PIP</option>
                    <option value="pp">8. PP</option>
                    <option value="upsCC">9. UPS-GE CC</option>
                </select>
            </div>
            <div class="col-sm-5 col-12">
                <label class="form-label">
                    <i class="fas fa-search me-1"></i> Búsqueda en hoja
                </label>
                <div class="input-group input-group-sm">
                    <span class="input-group-text bg-light">
                        <i class="fas fa-search"></i>
                    </span>
                    <input type="text" class="form-control" id="searchInput"
                        placeholder="Escriba para filtrar en todas las columnas...">
                    <button class="btn btn-outline-secondary" type="button" id="clearSearch" title="Limpiar búsqueda">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="col-sm-3 col-12">
                <label class="form-label">
                    <i class="fas fa-download me-1"></i> Descargar
                </label>
                <button type="button" class="btn btn-success btn-sm w-100" id="downloadPendientes">
                    <i class="fas fa-file-excel me-1"></i> Pendientes
                </button>
            </div>
        </div>
    </div>

    <!-- Información de resultados -->
    <div class="alert alert-info d-none" id="resultsInfo" role="alert">
        <i class="fas fa-info-circle"></i>
        <span id="resultsText"></span>
    </div>


    <!-- Tabla tipo hoja de cálculo -->
    <div class="sheet-wrapper">
        <div class="sheet-header">
            <div class="sheet-header-title">
                <i class="fas fa-table"></i>
                <span>Hoja de preventivos</span>
                <small class="d-none d-sm-inline" id="recordCount">Total de registros: 0</small>
            </div>
        </div>
        <div class="sheet-body">
            <table class="table table-sm table-hover table-bordered" id="preventivosTable">
                <thead>
                    <tr id="tableHeaders">
                        <!-- Los encabezados se insertarán dinámicamente desde JavaScript -->
                    </tr>
                </thead>
                <tbody id="preventivosTableBody">
                    <tr>
                        <td colspan="10" class="text-center text-muted py-4">
                            <i class="fas fa-hand-pointer fa-2x mb-2"></i><br>
                            Seleccione un tipo de equipo para ver los datos.
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Contador de registros para pantallas pequeñas -->
    <div class="mt-1 d-sm-none">
        <small class="text-muted" id="recordCountMobile">Total de registros: 0</small>
    </div>

    <!-- KPIs Dashboard -->
    <div class="sheet-card mb-3" id="kpisDashboard">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <div class="fw-semibold text-dark">
                <i class="fas fa-chart-pie me-1"></i> KPIs - Avance de Gestión
            </div>
            <button type="button" class="btn btn-sm btn-outline-primary" id="toggleKPIs">
                <i class="fas fa-sync-alt me-1"></i> Actualizar KPIs
            </button>
        </div>

        <div class="row g-3" id="kpisContainer">
            <!-- Los gráficos se insertarán dinámicamente aquí -->
        </div>
    </div>


</form>